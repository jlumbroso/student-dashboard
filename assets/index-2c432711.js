(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const p of l)if(p.type==="childList")for(const a of p.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(l){const p={};return l.integrity&&(p.integrity=l.integrity),l.referrerPolicy&&(p.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?p.credentials="include":l.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function n(l){if(l.ep)return;l.ep=!0;const p=s(l);fetch(l.href,p)}})();function ie(){}function wt(t){return t()}function lt(){return Object.create(null)}function Ce(t){t.forEach(wt)}function Xe(t){return typeof t=="function"}function Te(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Be;function ze(t,e){return Be||(Be=document.createElement("a")),Be.href=e,t===Be.href}function At(t){return Object.keys(t).length===0}function et(t,...e){if(t==null)return ie;const s=t.subscribe(...e);return s.unsubscribe?()=>s.unsubscribe():s}function It(t){let e;return et(t,s=>e=s)(),e}function $e(t,e,s){t.$$.on_destroy.push(et(e,s))}function o(t,e){t.appendChild(e)}function ue(t,e,s){t.insertBefore(e,s||null)}function ae(t){t.parentNode&&t.parentNode.removeChild(t)}function qe(t,e){for(let s=0;s<t.length;s+=1)t[s]&&t[s].d(e)}function v(t){return document.createElement(t)}function Y(t){return document.createTextNode(t)}function H(){return Y(" ")}function oe(t,e,s,n){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s,n)}function f(t,e,s){s==null?t.removeAttribute(e):t.getAttribute(e)!==s&&t.setAttribute(e,s)}function Ft(t){return Array.from(t.childNodes)}function ce(t,e){e=""+e,t.data!==e&&(t.data=e)}function at(t,e,s,n){s==null?t.style.removeProperty(e):t.style.setProperty(e,s,n?"important":"")}function _e(t,e,s){t.classList[s?"add":"remove"](e)}let tt;function De(t){tt=t}const Ae=[],ot=[];let Fe=[];const ct=[],Tt=Promise.resolve();let Ye=!1;function Ut(){Ye||(Ye=!0,Tt.then(Ct))}function Qe(t){Fe.push(t)}const Ke=new Set;let Oe=0;function Ct(){if(Oe!==0)return;const t=tt;do{try{for(;Oe<Ae.length;){const e=Ae[Oe];Oe++,De(e),Mt(e.$$)}}catch(e){throw Ae.length=0,Oe=0,e}for(De(null),Ae.length=0,Oe=0;ot.length;)ot.pop()();for(let e=0;e<Fe.length;e+=1){const s=Fe[e];Ke.has(s)||(Ke.add(s),s())}Fe.length=0}while(Ae.length);for(;ct.length;)ct.pop()();Ye=!1,Ke.clear(),De(t)}function Mt(t){if(t.fragment!==null){t.update(),Ce(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Qe)}}function $t(t){const e=[],s=[];Fe.forEach(n=>t.indexOf(n)===-1?e.push(n):s.push(n)),s.forEach(n=>n()),Fe=e}const Je=new Set;let Se;function Dt(){Se={r:0,c:[],p:Se}}function Nt(){Se.r||Ce(Se.c),Se=Se.p}function Ee(t,e){t&&t.i&&(Je.delete(t),t.i(e))}function Ie(t,e,s,n){if(t&&t.o){if(Je.has(t))return;Je.add(t),Se.c.push(()=>{Je.delete(t),n&&(s&&t.d(1),n())}),t.o(e)}else n&&n()}function Ve(t){t&&t.c()}function Ne(t,e,s,n){const{fragment:l,after_update:p}=t.$$;l&&l.m(e,s),n||Qe(()=>{const a=t.$$.on_mount.map(wt).filter(Xe);t.$$.on_destroy?t.$$.on_destroy.push(...a):Ce(a),t.$$.on_mount=[]}),p.forEach(Qe)}function Pe(t,e){const s=t.$$;s.fragment!==null&&($t(s.after_update),Ce(s.on_destroy),s.fragment&&s.fragment.d(e),s.on_destroy=s.fragment=null,s.ctx=[])}function Pt(t,e){t.$$.dirty[0]===-1&&(Ae.push(t),Ut(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function He(t,e,s,n,l,p,a,m=[-1]){const y=tt;De(t);const d=t.$$={fragment:null,ctx:[],props:p,update:ie,not_equal:l,bound:lt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(y?y.$$.context:[])),callbacks:lt(),dirty:m,skip_bound:!1,root:e.target||y.$$.root};a&&a(d.root);let N=!1;if(d.ctx=s?s(t,e.props||{},(G,q,...S)=>{const F=S.length?S[0]:q;return d.ctx&&l(d.ctx[G],d.ctx[G]=F)&&(!d.skip_bound&&d.bound[G]&&d.bound[G](F),N&&Pt(t,G)),q}):[],d.update(),N=!0,Ce(d.before_update),d.fragment=n?n(d.ctx):!1,e.target){if(e.hydrate){const G=Ft(e.target);d.fragment&&d.fragment.l(G),G.forEach(ae)}else d.fragment&&d.fragment.c();e.intro&&Ee(t.$$.fragment),Ne(t,e.target,e.anchor,e.customElement),Ct()}De(y)}class Ge{$destroy(){Pe(this,1),this.$destroy=ie}$on(e,s){if(!Xe(s))return ie;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(s),()=>{const l=n.indexOf(s);l!==-1&&n.splice(l,1)}}$set(e){this.$$set&&!At(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var St=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Et(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Lt={exports:{}};(function(t){(function(e,s){t.exports?t.exports=s():e.log=s()})(St,function(){var e=function(){},s="undefined",n=typeof window!==s&&typeof window.navigator!==s&&/Trident\/|MSIE /.test(window.navigator.userAgent),l=["trace","debug","info","warn","error"],p={},a=null;function m(k,R){var g=k[R];if(typeof g.bind=="function")return g.bind(k);try{return Function.prototype.bind.call(g,k)}catch{return function(){return Function.prototype.apply.apply(g,[k,arguments])}}}function y(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(k){return k==="debug"&&(k="log"),typeof console===s?!1:k==="trace"&&n?y:console[k]!==void 0?m(console,k):console.log!==void 0?m(console,"log"):e}function N(){for(var k=this.getLevel(),R=0;R<l.length;R++){var g=l[R];this[g]=R<k?e:this.methodFactory(g,k,this.name)}if(this.log=this.debug,typeof console===s&&k<this.levels.SILENT)return"No console available for logging"}function G(k){return function(){typeof console!==s&&(N.call(this),this[k].apply(this,arguments))}}function q(k,R,g){return d(k)||G.apply(this,arguments)}function S(k,R){var g=this,E,T,A,C="loglevel";typeof k=="string"?C+=":"+k:typeof k=="symbol"&&(C=void 0);function D(u){var h=(l[u]||"silent").toUpperCase();if(!(typeof window===s||!C)){try{window.localStorage[C]=h;return}catch{}try{window.document.cookie=encodeURIComponent(C)+"="+h+";"}catch{}}}function I(){var u;if(!(typeof window===s||!C)){try{u=window.localStorage[C]}catch{}if(typeof u===s)try{var h=window.document.cookie,w=encodeURIComponent(C),B=h.indexOf(w+"=");B!==-1&&(u=/^([^;]+)/.exec(h.slice(B+w.length+1))[1])}catch{}return g.levels[u]===void 0&&(u=void 0),u}}function r(){if(!(typeof window===s||!C)){try{window.localStorage.removeItem(C)}catch{}try{window.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function i(u){var h=u;if(typeof h=="string"&&g.levels[h.toUpperCase()]!==void 0&&(h=g.levels[h.toUpperCase()]),typeof h=="number"&&h>=0&&h<=g.levels.SILENT)return h;throw new TypeError("log.setLevel() called with invalid level: "+u)}g.name=k,g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=R||q,g.getLevel=function(){return A??T??E},g.setLevel=function(u,h){return A=i(u),h!==!1&&D(A),N.call(g)},g.setDefaultLevel=function(u){T=i(u),I()||g.setLevel(u,!1)},g.resetLevel=function(){A=null,r(),N.call(g)},g.enableAll=function(u){g.setLevel(g.levels.TRACE,u)},g.disableAll=function(u){g.setLevel(g.levels.SILENT,u)},g.rebuild=function(){if(a!==g&&(E=i(a.getLevel())),N.call(g),a===g)for(var u in p)p[u].rebuild()},E=i(a?a.getLevel():"WARN");var c=I();c!=null&&(A=i(c)),N.call(g)}a=new S,a.getLogger=function(R){if(typeof R!="symbol"&&typeof R!="string"||R==="")throw new TypeError("You must supply a name when creating a logger.");var g=p[R];return g||(g=p[R]=new S(R,a.methodFactory)),g};var F=typeof window!==s?window.log:void 0;return a.noConflict=function(){return typeof window!==s&&window.log===a&&(window.log=F),a},a.getLoggers=function(){return p},a.default=a,a})})(Lt);var Ht=Lt.exports;const le=Et(Ht);var Rt={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((s,n)=>{t.exports=n()})(St,function s(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},l,p=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,m={},y=0,d={};function N(r){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(i){var c=C(i);c.chunkSize=parseInt(c.chunkSize),i.step||i.chunk||(c.chunkSize=null),this._handle=new k(c),(this._handle.streamer=this)._config=c}).call(this,r),this.parseChunk=function(i,c){var u=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<u){let w=this._config.newline;w||(h=this._config.quoteChar||'"',w=this._handle.guessLineEndings(i,h)),i=[...i.split(w).slice(u)].join(w)}this.isFirstChunk&&I(this._config.beforeFirstChunk)&&(h=this._config.beforeFirstChunk(i))!==void 0&&(i=h),this.isFirstChunk=!1,this._halted=!1;var u=this._partialLine+i,h=(this._partialLine="",this._handle.parse(u,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(i=h.meta.cursor,u=(this._finished||(this._partialLine=u.substring(i-this._baseIndex),this._baseIndex=i),h&&h.data&&(this._rowCount+=h.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:h,workerId:d.WORKER_ID,finished:u});else if(I(this._config.chunk)&&!c){if(this._config.chunk(h,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=h=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(h.data),this._completeResults.errors=this._completeResults.errors.concat(h.errors),this._completeResults.meta=h.meta),this._completed||!u||!I(this._config.complete)||h&&h.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||h&&h.meta.paused||this._nextChunk(),h}this._halted=!0},this._sendError=function(i){I(this._config.error)?this._config.error(i):a&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:i,finished:!1})}}function G(r){var i;(r=r||{}).chunkSize||(r.chunkSize=d.RemoteChunkSize),N.call(this,r),this._nextChunk=p?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(i=new XMLHttpRequest,this._config.withCredentials&&(i.withCredentials=this._config.withCredentials),p||(i.onload=D(this._chunkLoaded,this),i.onerror=D(this._chunkError,this)),i.open(this._config.downloadRequestBody?"POST":"GET",this._input,!p),this._config.downloadRequestHeaders){var c,u=this._config.downloadRequestHeaders;for(c in u)i.setRequestHeader(c,u[c])}var h;this._config.chunkSize&&(h=this._start+this._config.chunkSize-1,i.setRequestHeader("Range","bytes="+this._start+"-"+h));try{i.send(this._config.downloadRequestBody)}catch(w){this._chunkError(w.message)}p&&i.status===0&&this._chunkError()}},this._chunkLoaded=function(){i.readyState===4&&(i.status<200||400<=i.status?this._chunkError():(this._start+=this._config.chunkSize||i.responseText.length,this._finished=!this._config.chunkSize||this._start>=(c=>(c=c.getResponseHeader("Content-Range"))!==null?parseInt(c.substring(c.lastIndexOf("/")+1)):-1)(i),this.parseChunk(i.responseText)))},this._chunkError=function(c){c=i.statusText||c,this._sendError(new Error(c))}}function q(r){(r=r||{}).chunkSize||(r.chunkSize=d.LocalChunkSize),N.call(this,r);var i,c,u=typeof FileReader<"u";this.stream=function(h){this._input=h,c=h.slice||h.webkitSlice||h.mozSlice,u?((i=new FileReader).onload=D(this._chunkLoaded,this),i.onerror=D(this._chunkError,this)):i=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var h=this._input,w=(this._config.chunkSize&&(w=Math.min(this._start+this._config.chunkSize,this._input.size),h=c.call(h,this._start,w)),i.readAsText(h,this._config.encoding));u||this._chunkLoaded({target:{result:w}})},this._chunkLoaded=function(h){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(h.target.result)},this._chunkError=function(){this._sendError(i.error)}}function S(r){var i;N.call(this,r=r||{}),this.stream=function(c){return i=c,this._nextChunk()},this._nextChunk=function(){var c,u;if(!this._finished)return c=this._config.chunkSize,i=c?(u=i.substring(0,c),i.substring(c)):(u=i,""),this._finished=!i,this.parseChunk(u)}}function F(r){N.call(this,r=r||{});var i=[],c=!0,u=!1;this.pause=function(){N.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){N.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(h){this._input=h,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&i.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),i.length?this.parseChunk(i.shift()):c=!0},this._streamData=D(function(h){try{i.push(typeof h=="string"?h:h.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(i.shift()))}catch(w){this._streamError(w)}},this),this._streamError=D(function(h){this._streamCleanUp(),this._sendError(h)},this),this._streamEnd=D(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=D(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(r){var i,c,u,h,w=Math.pow(2,53),B=-w,W=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,X=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,x=0,j=0,M=!1,_=!1,O=[],U={data:[],errors:[],meta:{}};function Z(b){return r.skipEmptyLines==="greedy"?b.join("").trim()==="":b.length===1&&b[0].length===0}function z(){if(U&&u&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),u=!1),r.skipEmptyLines&&(U.data=U.data.filter(function(ne){return!Z(ne)})),te()){let ne=function(de,se){I(r.transformHeader)&&(de=r.transformHeader(de,se)),O.push(de)};var V=ne;if(U)if(Array.isArray(U.data[0])){for(var b=0;te()&&b<U.data.length;b++)U.data[b].forEach(ne);U.data.splice(0,1)}else U.data.forEach(ne)}function J(ne,de){for(var se=r.header?{}:[],ee=0;ee<ne.length;ee++){var K=ee,pe=ne[ee],pe=((Q,re)=>(fe=>(r.dynamicTypingFunction&&r.dynamicTyping[fe]===void 0&&(r.dynamicTyping[fe]=r.dynamicTypingFunction(fe)),(r.dynamicTyping[fe]||r.dynamicTyping)===!0))(Q)?re==="true"||re==="TRUE"||re!=="false"&&re!=="FALSE"&&((fe=>{if(W.test(fe)&&(fe=parseFloat(fe),B<fe&&fe<w))return 1})(re)?parseFloat(re):X.test(re)?new Date(re):re===""?null:re):re)(K=r.header?ee>=O.length?"__parsed_extra":O[ee]:K,pe=r.transform?r.transform(pe,K):pe);K==="__parsed_extra"?(se[K]=se[K]||[],se[K].push(pe)):se[K]=pe}return r.header&&(ee>O.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+O.length+" fields but parsed "+ee,j+de):ee<O.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+O.length+" fields but parsed "+ee,j+de)),se}var $;U&&(r.header||r.dynamicTyping||r.transform)&&($=1,!U.data.length||Array.isArray(U.data[0])?(U.data=U.data.map(J),$=U.data.length):U.data=J(U.data,0),r.header&&U.meta&&(U.meta.fields=O),j+=$)}function te(){return r.header&&O.length===0}function P(b,J,$,V){b={type:b,code:J,message:$},V!==void 0&&(b.row=V),U.errors.push(b)}I(r.step)&&(h=r.step,r.step=function(b){U=b,te()?z():(z(),U.data.length!==0&&(x+=b.data.length,r.preview&&x>r.preview?c.abort():(U.data=U.data[0],h(U,L))))}),this.parse=function(b,J,$){var V=r.quoteChar||'"',V=(r.newline||(r.newline=this.guessLineEndings(b,V)),u=!1,r.delimiter?I(r.delimiter)&&(r.delimiter=r.delimiter(b),U.meta.delimiter=r.delimiter):((V=((ne,de,se,ee,K)=>{var pe,Q,re,fe;K=K||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Le=0;Le<K.length;Le++){for(var be,Ue=K[Le],ge=0,ye=0,he=0,me=(re=void 0,new g({comments:ee,delimiter:Ue,newline:de,preview:10}).parse(ne)),we=0;we<me.data.length;we++)se&&Z(me.data[we])?he++:(be=me.data[we].length,ye+=be,re===void 0?re=be:0<be&&(ge+=Math.abs(be-re),re=be));0<me.data.length&&(ye/=me.data.length-he),(Q===void 0||ge<=Q)&&(fe===void 0||fe<ye)&&1.99<ye&&(Q=ge,pe=Ue,fe=ye)}return{successful:!!(r.delimiter=pe),bestDelimiter:pe}})(b,r.newline,r.skipEmptyLines,r.comments,r.delimitersToGuess)).successful?r.delimiter=V.bestDelimiter:(u=!0,r.delimiter=d.DefaultDelimiter),U.meta.delimiter=r.delimiter),C(r));return r.preview&&r.header&&V.preview++,i=b,c=new g(V),U=c.parse(i,J,$),z(),M?{meta:{paused:!0}}:U||{meta:{paused:!1}}},this.paused=function(){return M},this.pause=function(){M=!0,c.abort(),i=I(r.chunk)?"":i.substring(c.getCharIndex())},this.resume=function(){L.streamer._halted?(M=!1,L.streamer.parseChunk(i,!0)):setTimeout(L.resume,3)},this.aborted=function(){return _},this.abort=function(){_=!0,c.abort(),U.meta.aborted=!0,I(r.complete)&&r.complete(U),i=""},this.guessLineEndings=function(ne,V){ne=ne.substring(0,1048576);var V=new RegExp(R(V)+"([^]*?)"+R(V),"gm"),$=(ne=ne.replace(V,"")).split("\r"),V=ne.split(`
`),ne=1<V.length&&V[0].length<$[0].length;if($.length===1||ne)return`
`;for(var de=0,se=0;se<$.length;se++)$[se][0]===`
`&&de++;return de>=$.length/2?`\r
`:"\r"}}function R(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(r){var i=(r=r||{}).delimiter,c=r.newline,u=r.comments,h=r.step,w=r.preview,B=r.fastMode,W=null,X=!1,L=r.quoteChar==null?'"':r.quoteChar,x=L;if(r.escapeChar!==void 0&&(x=r.escapeChar),(typeof i!="string"||-1<d.BAD_DELIMITERS.indexOf(i))&&(i=","),u===i)throw new Error("Comment character same as delimiter");u===!0?u="#":(typeof u!="string"||-1<d.BAD_DELIMITERS.indexOf(u))&&(u=!1),c!==`
`&&c!=="\r"&&c!==`\r
`&&(c=`
`);var j=0,M=!1;this.parse=function(_,O,U){if(typeof _!="string")throw new Error("Input must be a string");var Z=_.length,z=i.length,te=c.length,P=u.length,b=I(h),J=[],$=[],V=[],ne=j=0;if(!_)return ge();if(B||B!==!1&&_.indexOf(L)===-1){for(var de=_.split(c),se=0;se<de.length;se++){if(V=de[se],j+=V.length,se!==de.length-1)j+=c.length;else if(U)return ge();if(!u||V.substring(0,P)!==u){if(b){if(J=[],fe(V.split(i)),ye(),M)return ge()}else fe(V.split(i));if(w&&w<=se)return J=J.slice(0,w),ge(!0)}}return ge()}for(var ee=_.indexOf(i,j),K=_.indexOf(c,j),pe=new RegExp(R(x)+R(L),"g"),Q=_.indexOf(L,j);;)if(_[j]===L)for(Q=j,j++;;){if((Q=_.indexOf(L,Q+1))===-1)return U||$.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:J.length,index:j}),be();if(Q===Z-1)return be(_.substring(j,Q).replace(pe,L));if(L===x&&_[Q+1]===x)Q++;else if(L===x||Q===0||_[Q-1]!==x){ee!==-1&&ee<Q+1&&(ee=_.indexOf(i,Q+1));var re=Le((K=K!==-1&&K<Q+1?_.indexOf(c,Q+1):K)===-1?ee:Math.min(ee,K));if(_.substr(Q+1+re,z)===i){V.push(_.substring(j,Q).replace(pe,L)),_[j=Q+1+re+z]!==L&&(Q=_.indexOf(L,j)),ee=_.indexOf(i,j),K=_.indexOf(c,j);break}if(re=Le(K),_.substring(Q+1+re,Q+1+re+te)===c){if(V.push(_.substring(j,Q).replace(pe,L)),Ue(Q+1+re+te),ee=_.indexOf(i,j),Q=_.indexOf(L,j),b&&(ye(),M))return ge();if(w&&J.length>=w)return ge(!0);break}$.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:J.length,index:j}),Q++}}else if(u&&V.length===0&&_.substring(j,j+P)===u){if(K===-1)return ge();j=K+te,K=_.indexOf(c,j),ee=_.indexOf(i,j)}else if(ee!==-1&&(ee<K||K===-1))V.push(_.substring(j,ee)),j=ee+z,ee=_.indexOf(i,j);else{if(K===-1)break;if(V.push(_.substring(j,K)),Ue(K+te),b&&(ye(),M))return ge();if(w&&J.length>=w)return ge(!0)}return be();function fe(he){J.push(he),ne=j}function Le(he){var me=0;return me=he!==-1&&(he=_.substring(Q+1,he))&&he.trim()===""?he.length:me}function be(he){return U||(he===void 0&&(he=_.substring(j)),V.push(he),j=Z,fe(V),b&&ye()),ge()}function Ue(he){j=he,fe(V),V=[],K=_.indexOf(c,j)}function ge(he){if(r.header&&!O&&J.length&&!X){var me=J[0],we={},xe=new Set(me);let rt=!1;for(let Re=0;Re<me.length;Re++){let ke=me[Re];if(we[ke=I(r.transformHeader)?r.transformHeader(ke,Re):ke]){let Me,it=we[ke];for(;Me=ke+"_"+it,it++,xe.has(Me););xe.add(Me),me[Re]=Me,we[ke]++,rt=!0,(W=W===null?{}:W)[Me]=ke}else we[ke]=1,me[Re]=ke;xe.add(ke)}rt&&console.warn("Duplicate headers found and renamed."),X=!0}return{data:J,errors:$,meta:{delimiter:i,linebreak:c,aborted:M,truncated:!!he,cursor:ne+(O||0),renamedHeaders:W}}}function ye(){h(ge()),J=[],$=[]}},this.abort=function(){M=!0},this.getCharIndex=function(){return j}}function E(r){var i=r.data,c=m[i.workerId],u=!1;if(i.error)c.userError(i.error,i.file);else if(i.results&&i.results.data){var h={abort:function(){u=!0,T(i.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:A,resume:A};if(I(c.userStep)){for(var w=0;w<i.results.data.length&&(c.userStep({data:i.results.data[w],errors:i.results.errors,meta:i.results.meta},h),!u);w++);delete i.results}else I(c.userChunk)&&(c.userChunk(i.results,h,i.file),delete i.results)}i.finished&&!u&&T(i.workerId,i.results)}function T(r,i){var c=m[r];I(c.userComplete)&&c.userComplete(i),c.terminate(),delete m[r]}function A(){throw new Error("Not implemented.")}function C(r){if(typeof r!="object"||r===null)return r;var i,c=Array.isArray(r)?[]:{};for(i in r)c[i]=C(r[i]);return c}function D(r,i){return function(){r.apply(i,arguments)}}function I(r){return typeof r=="function"}return d.parse=function(r,i){var c=(i=i||{}).dynamicTyping||!1;if(I(c)&&(i.dynamicTypingFunction=c,c={}),i.dynamicTyping=c,i.transform=!!I(i.transform)&&i.transform,!i.worker||!d.WORKERS_SUPPORTED)return c=null,d.NODE_STREAM_INPUT,typeof r=="string"?(r=(u=>u.charCodeAt(0)!==65279?u:u.slice(1))(r),c=new(i.download?G:S)(i)):r.readable===!0&&I(r.read)&&I(r.on)?c=new F(i):(n.File&&r instanceof File||r instanceof Object)&&(c=new q(i)),c.stream(r);(c=(()=>{var u;return!!d.WORKERS_SUPPORTED&&(u=(()=>{var h=n.URL||n.webkitURL||null,w=s.toString();return d.BLOB_URL||(d.BLOB_URL=h.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",w,")();"],{type:"text/javascript"})))})(),(u=new n.Worker(u)).onmessage=E,u.id=y++,m[u.id]=u)})()).userStep=i.step,c.userChunk=i.chunk,c.userComplete=i.complete,c.userError=i.error,i.step=I(i.step),i.chunk=I(i.chunk),i.complete=I(i.complete),i.error=I(i.error),delete i.worker,c.postMessage({input:r,config:i,workerId:c.id})},d.unparse=function(r,i){var c=!1,u=!0,h=",",w=`\r
`,B='"',W=B+B,X=!1,L=null,x=!1,j=((()=>{if(typeof i=="object"){if(typeof i.delimiter!="string"||d.BAD_DELIMITERS.filter(function(O){return i.delimiter.indexOf(O)!==-1}).length||(h=i.delimiter),typeof i.quotes!="boolean"&&typeof i.quotes!="function"&&!Array.isArray(i.quotes)||(c=i.quotes),typeof i.skipEmptyLines!="boolean"&&typeof i.skipEmptyLines!="string"||(X=i.skipEmptyLines),typeof i.newline=="string"&&(w=i.newline),typeof i.quoteChar=="string"&&(B=i.quoteChar),typeof i.header=="boolean"&&(u=i.header),Array.isArray(i.columns)){if(i.columns.length===0)throw new Error("Option columns is empty");L=i.columns}i.escapeChar!==void 0&&(W=i.escapeChar+B),i.escapeFormulae instanceof RegExp?x=i.escapeFormulae:typeof i.escapeFormulae=="boolean"&&i.escapeFormulae&&(x=/^[=+\-@\t\r].*$/)}})(),new RegExp(R(B),"g"));if(typeof r=="string"&&(r=JSON.parse(r)),Array.isArray(r)){if(!r.length||Array.isArray(r[0]))return M(null,r,X);if(typeof r[0]=="object")return M(L||Object.keys(r[0]),r,X)}else if(typeof r=="object")return typeof r.data=="string"&&(r.data=JSON.parse(r.data)),Array.isArray(r.data)&&(r.fields||(r.fields=r.meta&&r.meta.fields||L),r.fields||(r.fields=Array.isArray(r.data[0])?r.fields:typeof r.data[0]=="object"?Object.keys(r.data[0]):[]),Array.isArray(r.data[0])||typeof r.data[0]=="object"||(r.data=[r.data])),M(r.fields||[],r.data||[],X);throw new Error("Unable to serialize unrecognized input");function M(O,U,Z){var z="",te=(typeof O=="string"&&(O=JSON.parse(O)),typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(O)&&0<O.length),P=!Array.isArray(U[0]);if(te&&u){for(var b=0;b<O.length;b++)0<b&&(z+=h),z+=_(O[b],b);0<U.length&&(z+=w)}for(var J=0;J<U.length;J++){var $=(te?O:U[J]).length,V=!1,ne=te?Object.keys(U[J]).length===0:U[J].length===0;if(Z&&!te&&(V=Z==="greedy"?U[J].join("").trim()==="":U[J].length===1&&U[J][0].length===0),Z==="greedy"&&te){for(var de=[],se=0;se<$;se++){var ee=P?O[se]:se;de.push(U[J][ee])}V=de.join("").trim()===""}if(!V){for(var K=0;K<$;K++){0<K&&!ne&&(z+=h);var pe=te&&P?O[K]:K;z+=_(U[J][pe],K)}J<U.length-1&&(!Z||0<$&&!ne)&&(z+=w)}}return z}function _(O,U){var Z,z;return O==null?"":O.constructor===Date?JSON.stringify(O).slice(1,25):(z=!1,x&&typeof O=="string"&&x.test(O)&&(O="'"+O,z=!0),Z=O.toString().replace(j,W),(z=z||c===!0||typeof c=="function"&&c(O,U)||Array.isArray(c)&&c[U]||((te,P)=>{for(var b=0;b<P.length;b++)if(-1<te.indexOf(P[b]))return!0;return!1})(Z,d.BAD_DELIMITERS)||-1<Z.indexOf(h)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?B+Z+B:Z)}},d.RECORD_SEP=String.fromCharCode(30),d.UNIT_SEP=String.fromCharCode(31),d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!p&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=g,d.ParserHandle=k,d.NetworkStreamer=G,d.FileStreamer=q,d.StringStreamer=S,d.ReadableStreamStreamer=F,n.jQuery&&((l=n.jQuery).fn.parse=function(r){var i=r.config||{},c=[];return this.each(function(w){if(!(l(this).prop("tagName").toUpperCase()==="INPUT"&&l(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var B=0;B<this.files.length;B++)c.push({file:this.files[B],inputElem:this,instanceConfig:l.extend({},i)})}),u(),this;function u(){if(c.length===0)I(r.complete)&&r.complete();else{var w,B,W,X,L=c[0];if(I(r.before)){var x=r.before(L.file,L.inputElem);if(typeof x=="object"){if(x.action==="abort")return w="AbortError",B=L.file,W=L.inputElem,X=x.reason,void(I(r.error)&&r.error({name:w},B,W,X));if(x.action==="skip")return void h();typeof x.config=="object"&&(L.instanceConfig=l.extend(L.instanceConfig,x.config))}else if(x==="skip")return void h()}var j=L.instanceConfig.complete;L.instanceConfig.complete=function(M){I(j)&&j(M,L.file,L.inputElem),h()},d.parse(L.file,L.instanceConfig)}}function h(){c.splice(0,1),u()}}),a&&(n.onmessage=function(r){r=r.data,d.WORKER_ID===void 0&&r&&(d.WORKER_ID=r.workerId),typeof r.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse(r.input,r.config),finished:!0}):(n.File&&r.input instanceof File||r.input instanceof Object)&&(r=d.parse(r.input,r.config))&&n.postMessage({workerId:d.WORKER_ID,results:r,finished:!0})}),(G.prototype=Object.create(N.prototype)).constructor=G,(q.prototype=Object.create(N.prototype)).constructor=q,(S.prototype=Object.create(S.prototype)).constructor=S,(F.prototype=Object.create(N.prototype)).constructor=F,d})})(Rt);var Gt=Rt.exports;const ut=Et(Gt),je=[];function Bt(t,e){return{subscribe:nt(t,e).subscribe}}function nt(t,e=ie){let s;const n=new Set;function l(m){if(Te(t,m)&&(t=m,s)){const y=!je.length;for(const d of n)d[1](),je.push(d,t);if(y){for(let d=0;d<je.length;d+=2)je[d][0](je[d+1]);je.length=0}}}function p(m){l(m(t))}function a(m,y=ie){const d=[m,y];return n.add(d),n.size===1&&(s=e(l)||ie),m(t),()=>{n.delete(d),n.size===0&&s&&(s(),s=null)}}return{set:l,update:p,subscribe:a}}function ft(t,e,s){const n=!Array.isArray(t),l=n?[t]:t,p=e.length<2;return Bt(s,a=>{let m=!1;const y=[];let d=0,N=ie;const G=()=>{if(d)return;N();const S=e(n?y[0]:y,a);p?a(S):N=Xe(S)?S:ie},q=l.map((S,F)=>et(S,k=>{y[F]=k,d&=~(1<<F),m&&G()},()=>{d|=1<<F}));return m=!0,G(),function(){Ce(q),N(),m=!1}})}function st(t){return new Promise((e,s)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>s(t.error)})}function Jt(t,e){const s=indexedDB.open(t);s.onupgradeneeded=()=>s.result.createObjectStore(e);const n=st(s);return(l,p)=>n.then(a=>p(a.transaction(e,l).objectStore(e)))}let We;function Ot(){return We||(We=Jt("keyval-store","keyval")),We}function zt(t,e=Ot()){return e("readonly",s=>st(s.get(t)))}function qt(t,e,s=Ot()){return s("readwrite",n=>(n.put(e,t),st(n.transaction)))}const ve=nt([]),Ze=nt({search:"",hasGitHub:"all",hasSlack:"all",major:"all",classification:"all"}),jt="student-dashboard-roster";async function Vt(){const t=await zt(jt);t&&ve.set(t)}function xt(t){return qt(jt,t)}ve.subscribe(t=>{t&&t.length>0&&xt(t)});function dt(t){let e,s;return{c(){e=v("div"),s=Y(t[0]),f(e,"class","status loading svelte-1a52a76")},m(n,l){ue(n,e,l),o(e,s)},p(n,l){l&1&&ce(s,n[0])},d(n){n&&ae(e)}}}function ht(t){let e,s;return{c(){e=v("div"),s=Y(t[1]),f(e,"class","status confirmation svelte-1a52a76")},m(n,l){ue(n,e,l),o(e,s)},p(n,l){l&2&&ce(s,n[1])},d(n){n&&ae(e)}}}function Kt(t){let e,s,n,l,p,a,m,y,d,N,G,q,S,F,k,R,g,E,T,A,C,D,I,r,i,c,u=t[0]&&dt(t),h=t[1]&&ht(t);return{c(){e=v("div"),s=v("h3"),s.textContent="Upload Data",n=H(),l=v("div"),p=v("label"),p.textContent="Classlist JSON:",a=H(),m=v("input"),y=H(),d=v("div"),N=v("label"),N.textContent="GitHub CSV:",G=H(),q=v("input"),S=H(),F=v("div"),k=v("label"),k.textContent="Slack CSV:",R=H(),g=v("input"),E=H(),T=v("div"),A=v("label"),A.textContent="Message JSON:",C=H(),D=v("input"),I=H(),u&&u.c(),r=H(),h&&h.c(),f(p,"for","classlist"),f(p,"class","svelte-1a52a76"),f(m,"id","classlist"),f(m,"type","file"),f(m,"accept",".json"),f(m,"class","svelte-1a52a76"),f(l,"class","svelte-1a52a76"),f(N,"for","github"),f(N,"class","svelte-1a52a76"),f(q,"id","github"),f(q,"type","file"),f(q,"accept",".csv"),f(q,"class","svelte-1a52a76"),f(d,"class","svelte-1a52a76"),f(k,"for","slack"),f(k,"class","svelte-1a52a76"),f(g,"id","slack"),f(g,"type","file"),f(g,"accept",".csv"),f(g,"class","svelte-1a52a76"),f(F,"class","svelte-1a52a76"),f(A,"for","messages"),f(A,"class","svelte-1a52a76"),f(D,"id","messages"),f(D,"type","file"),f(D,"accept",".json"),f(D,"class","svelte-1a52a76"),f(T,"class","svelte-1a52a76"),f(e,"class","upload-section svelte-1a52a76")},m(w,B){ue(w,e,B),o(e,s),o(e,n),o(e,l),o(l,p),o(l,a),o(l,m),o(e,y),o(e,d),o(d,N),o(d,G),o(d,q),o(e,S),o(e,F),o(F,k),o(F,R),o(F,g),o(e,E),o(e,T),o(T,A),o(T,C),o(T,D),o(e,I),u&&u.m(e,null),o(e,r),h&&h.m(e,null),i||(c=[oe(m,"change",t[2]),oe(q,"change",t[3]),oe(g,"change",t[4]),oe(D,"change",t[5])],i=!0)},p(w,[B]){w[0]?u?u.p(w,B):(u=dt(w),u.c(),u.m(e,r)):u&&(u.d(1),u=null),w[1]?h?h.p(w,B):(h=ht(w),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},i:ie,o:ie,d(w){w&&ae(e),u&&u.d(),h&&h.d(),i=!1,Ce(c)}}}function Wt(t,e,s){le.setLevel("debug");let n="",l="";async function p(S){if(s(0,n="Loading classlist JSON..."),le.debug("Processing JSON file:",S),!!S)try{const F=await S.text(),k=JSON.parse(F);le.debug("Parsed JSON data:",k),le.debug("Found",k.length,"students in JSON."),ve.set(k),s(1,l=`Loaded ${k.length} students from JSON.`)}catch(F){le.error("Error parsing JSON:",F),s(1,l=`Error loading JSON: ${F.message}`)}finally{s(0,n="")}}async function a(S){if(s(0,n="Loading GitHub CSV..."),le.debug("Processing GitHub CSV file:",S),!S)return;const F=await S.text(),k=ut.parse(F,{header:!0});le.debug("Parsed GitHub CSV:",k);const R=k.data,g={};let E=0;for(const T of R){const A=T["Your PennID:"]?T["Your PennID:"].trim():null;if(!A)continue;const C=T.Timestamp?T.Timestamp.trim():"",D=new Date(C).valueOf()||0,I=T["Your GitHub username:"]?T["Your GitHub username:"].trim():null;(!g[A]||D>g[A].dateVal)&&(g[A]={dateVal:D,githubUsername:I})}le.debug("Built GitHub map:",g),ve.update(T=>T.map(A=>{const C=g[A.studentId];return C&&C.githubUsername&&A.githubUsername!==C.githubUsername?(E++,{...A,githubUsername:C.githubUsername}):A})),s(1,l=E>0?`GitHub CSV processed: updated ${E} record${E===1?"":"s"}.`:"GitHub CSV processed: no changes made."),s(0,n="")}async function m(S){if(s(0,n="Loading Slack CSV..."),le.debug("Processing Slack CSV file:",S),!S)return;const F=await S.text(),k=ut.parse(F,{header:!0});le.debug("Parsed Slack CSV:",k);const R=k.data,g={};for(const E of R){if(!E.email)continue;const T=E.email.trim().toLowerCase(),A=E.userid?E.userid.trim():null,C=E.fullname?E.fullname.trim():null,D=E.displayname?E.displayname.trim():null;g[T]={userId:A,fullname:C,displayname:D}}le.debug("Built Slack map:",g),ve.update(E=>E.map(T=>{const A=T.EmailAddress?T.EmailAddress.toLowerCase():"",C=g[A];return C?{...T,slackUserId:C.userId,slackFullname:C.fullname,slackDisplayname:C.displayname,slackUsername:C.displayname||C.fullname}:T})),s(1,l="Slack CSV processed."),s(0,n="")}async function y(S){if(s(0,n="Loading message JSON..."),le.debug("Processing message JSON file:",S),!!S)try{const F=await S.text(),k=JSON.parse(F);le.debug("Parsed message data:",k),le.debug("Found",k.length,"messages in JSON.");const R=S.name;let g=0,E=0;const T=It(ve),A={};T.forEach((C,D)=>{C.slackUsername&&(A[C.slackUsername.toLowerCase()]=D),C.slackDisplayname&&(A[C.slackDisplayname.toLowerCase()]=D),C.slackFullname&&(A[C.slackFullname.toLowerCase()]=D)}),ve.update(C=>C.map(D=>{D.messages||(D.messages=[]);const I=k.filter(r=>{const i=r.username?r.username.toLowerCase():"";return A[i]!==void 0&&C[A[i]]&&C[A[i]].studentId===D.studentId});if(I.length>0){g+=I.length,E++;const r=I.map(i=>({timestamp:i.timestamp,source:R,text:i.text}));return{...D,messages:[...D.messages,...r]}}return D})),s(1,l=`Messages processed: matched ${g} messages to ${E} students.`)}catch(F){le.error("Error processing message JSON:",F),s(1,l=`Error processing message JSON: ${F.message}`)}finally{s(0,n="")}}function d(S){const F=S.target.files[0];le.info("File selected for Classlist:",F),p(F),S.target.value=""}function N(S){const F=S.target.files[0];le.info("File selected for GitHub CSV:",F),a(F),S.target.value=""}function G(S){const F=S.target.files[0];le.info("File selected for Slack CSV:",F),m(F),S.target.value=""}function q(S){const F=S.target.files[0];le.info("File selected for Message JSON:",F),y(F),S.target.value=""}return[n,l,d,N,G,q]}class Yt extends Ge{constructor(e){super(),He(this,e,Wt,Kt,Te,{})}}function pt(t,e,s){const n=t.slice();return n[15]=e[s],n}function gt(t,e,s){const n=t.slice();return n[18]=e[s],n}function _t(t){let e,s=t[18]+"",n,l;return{c(){e=v("option"),n=Y(s),e.__value=l=t[18],e.value=e.__value},m(p,a){ue(p,e,a),o(e,n)},p(p,a){a&2&&s!==(s=p[18]+"")&&ce(n,s),a&2&&l!==(l=p[18])&&(e.__value=l,e.value=e.__value)},d(p){p&&ae(e)}}}function mt(t){let e,s=t[15]+"",n,l;return{c(){e=v("option"),n=Y(s),e.__value=l=t[15],e.value=e.__value},m(p,a){ue(p,e,a),o(e,n)},p(p,a){a&4&&s!==(s=p[15]+"")&&ce(n,s),a&4&&l!==(l=p[15])&&(e.__value=l,e.value=e.__value)},d(p){p&&ae(e)}}}function Qt(t){let e,s,n,l,p,a,m,y,d,N,G,q,S,F,k,R,g,E,T,A,C,D,I,r,i,c,u,h,w,B,W,X,L,x,j,M,_,O,U,Z=t[1],z=[];for(let b=0;b<Z.length;b+=1)z[b]=_t(gt(t,Z,b));let te=t[2],P=[];for(let b=0;b<te.length;b+=1)P[b]=mt(pt(t,te,b));return{c(){e=v("div"),s=v("div"),n=v("label"),n.textContent="Search:",l=H(),p=v("input"),a=H(),m=v("fieldset"),y=v("legend"),y.textContent="GitHub:",d=H(),N=v("div"),G=v("button"),G.textContent="All",q=H(),S=v("button"),S.textContent="Yes",F=H(),k=v("button"),k.textContent="No",R=H(),g=v("fieldset"),E=v("legend"),E.textContent="Slack:",T=H(),A=v("div"),C=v("button"),C.textContent="All",D=H(),I=v("button"),I.textContent="Yes",r=H(),i=v("button"),i.textContent="No",c=H(),u=v("div"),h=v("label"),h.textContent="Major:",w=H(),B=v("select"),W=v("option"),W.textContent="All";for(let b=0;b<z.length;b+=1)z[b].c();X=H(),L=v("div"),x=v("label"),x.textContent="Classification:",j=H(),M=v("select"),_=v("option"),_.textContent="All";for(let b=0;b<P.length;b+=1)P[b].c();f(n,"for","searchInput"),f(n,"class","svelte-alvg9o"),f(p,"id","searchInput"),f(p,"type","text"),f(p,"placeholder","Name or Email"),f(p,"class","svelte-alvg9o"),f(s,"class","filter-item svelte-alvg9o"),f(y,"class","svelte-alvg9o"),f(G,"type","button"),f(G,"class","svelte-alvg9o"),_e(G,"active",t[0].hasGitHub==="all"),f(S,"type","button"),f(S,"class","svelte-alvg9o"),_e(S,"active",t[0].hasGitHub==="yes"),f(k,"type","button"),f(k,"class","svelte-alvg9o"),_e(k,"active",t[0].hasGitHub==="no"),f(N,"class","toggle-group svelte-alvg9o"),f(m,"class","filter-item svelte-alvg9o"),f(E,"class","svelte-alvg9o"),f(C,"type","button"),f(C,"class","svelte-alvg9o"),_e(C,"active",t[0].hasSlack==="all"),f(I,"type","button"),f(I,"class","svelte-alvg9o"),_e(I,"active",t[0].hasSlack==="yes"),f(i,"type","button"),f(i,"class","svelte-alvg9o"),_e(i,"active",t[0].hasSlack==="no"),f(A,"class","toggle-group svelte-alvg9o"),f(g,"class","filter-item svelte-alvg9o"),f(h,"for","majorSelect"),f(h,"class","svelte-alvg9o"),W.__value="all",W.value=W.__value,f(B,"id","majorSelect"),f(B,"class","svelte-alvg9o"),f(u,"class","filter-item svelte-alvg9o"),f(x,"for","classSelect"),f(x,"class","svelte-alvg9o"),_.__value="all",_.value=_.__value,f(M,"id","classSelect"),f(M,"class","svelte-alvg9o"),f(L,"class","filter-item svelte-alvg9o"),f(e,"class","filter-bar svelte-alvg9o")},m(b,J){ue(b,e,J),o(e,s),o(s,n),o(s,l),o(s,p),o(e,a),o(e,m),o(m,y),o(m,d),o(m,N),o(N,G),o(N,q),o(N,S),o(N,F),o(N,k),o(e,R),o(e,g),o(g,E),o(g,T),o(g,A),o(A,C),o(A,D),o(A,I),o(A,r),o(A,i),o(e,c),o(e,u),o(u,h),o(u,w),o(u,B),o(B,W);for(let $=0;$<z.length;$+=1)z[$]&&z[$].m(B,null);o(e,X),o(e,L),o(L,x),o(L,j),o(L,M),o(M,_);for(let $=0;$<P.length;$+=1)P[$]&&P[$].m(M,null);O||(U=[oe(p,"input",t[6]),oe(G,"click",t[7]),oe(S,"click",t[8]),oe(k,"click",t[9]),oe(C,"click",t[10]),oe(I,"click",t[11]),oe(i,"click",t[12]),oe(B,"change",t[13]),oe(M,"change",t[14])],O=!0)},p(b,[J]){if(J&1&&_e(G,"active",b[0].hasGitHub==="all"),J&1&&_e(S,"active",b[0].hasGitHub==="yes"),J&1&&_e(k,"active",b[0].hasGitHub==="no"),J&1&&_e(C,"active",b[0].hasSlack==="all"),J&1&&_e(I,"active",b[0].hasSlack==="yes"),J&1&&_e(i,"active",b[0].hasSlack==="no"),J&2){Z=b[1];let $;for($=0;$<Z.length;$+=1){const V=gt(b,Z,$);z[$]?z[$].p(V,J):(z[$]=_t(V),z[$].c(),z[$].m(B,null))}for(;$<z.length;$+=1)z[$].d(1);z.length=Z.length}if(J&4){te=b[2];let $;for($=0;$<te.length;$+=1){const V=pt(b,te,$);P[$]?P[$].p(V,J):(P[$]=mt(V),P[$].c(),P[$].m(M,null))}for(;$<P.length;$+=1)P[$].d(1);P.length=te.length}},i:ie,o:ie,d(b){b&&ae(e),qe(z,b),qe(P,b),O=!1,Ce(U)}}}function Zt(t,e,s){let n,l,p;$e(t,Ze,E=>s(0,n=E));const a=ft(ve,E=>{const T=new Set;return E.forEach(A=>{const C=A["Primary Major Title"]||A["Primary Major"];C&&T.add(C)}),Array.from(T).sort()});$e(t,a,E=>s(1,l=E));const m=ft(ve,E=>{const T=new Set;return E.forEach(A=>{const C=A.Classification;C&&T.add(C)}),Array.from(T).sort()});$e(t,m,E=>s(2,p=E));function y(E,T){Ze.update(A=>({...A,[E]:T}))}return[n,l,p,a,m,y,E=>y("search",E.target.value),()=>y("hasGitHub","all"),()=>y("hasGitHub","yes"),()=>y("hasGitHub","no"),()=>y("hasSlack","all"),()=>y("hasSlack","yes"),()=>y("hasSlack","no"),E=>y("major",E.target.value),E=>y("classification",E.target.value)]}class Xt extends Ge{constructor(e){super(),He(this,e,Zt,Qt,Te,{})}}function vt(t,e,s){const n=t.slice();return n[1]=e[s],n}function en(t){let e;return{c(){e=v("div"),e.textContent="GitHub: N/A"},m(s,n){ue(s,e,n)},p:ie,d(s){s&&ae(e)}}}function tn(t){let e,s,n,l,p=t[1].githubUsername+"",a,m;return{c(){e=v("div"),s=Y("GitHub: "),n=v("a"),l=Y("@"),a=Y(p),f(n,"href",m="https://github.com/"+t[1].githubUsername),f(n,"target","_blank"),f(n,"rel","noopener"),f(n,"class","svelte-121v7tt")},m(y,d){ue(y,e,d),o(e,s),o(e,n),o(n,l),o(n,a)},p(y,d){d&1&&p!==(p=y[1].githubUsername+"")&&ce(a,p),d&1&&m!==(m="https://github.com/"+y[1].githubUsername)&&f(n,"href",m)},d(y){y&&ae(e)}}}function nn(t){let e;return{c(){e=v("div"),e.textContent="Slack: N/A"},m(s,n){ue(s,e,n)},p:ie,d(s){s&&ae(e)}}}function sn(t){let e,s,n,l=(t[1].slackDisplayname||t[1].slackFullname||t[1].First)+"",p,a;return{c(){e=v("div"),s=Y("Slack: "),n=v("a"),p=Y(l),f(n,"href",a="https://penn-cis-3500.slack.com/team/"+t[1].slackUserId),f(n,"target","_blank"),f(n,"rel","noopener"),f(n,"class","svelte-121v7tt")},m(m,y){ue(m,e,y),o(e,s),o(e,n),o(n,p)},p(m,y){y&1&&l!==(l=(m[1].slackDisplayname||m[1].slackFullname||m[1].First)+"")&&ce(p,l),y&1&&a!==(a="https://penn-cis-3500.slack.com/team/"+m[1].slackUserId)&&f(n,"href",a)},d(m){m&&ae(e)}}}function bt(t){let e,s,n,l,p,a,m,y,d=t[1].First+"",N,G,q=t[1].Last+"",S,F,k,R=t[1].EmailAddress+"",g,E,T,A,C=(t[1]["Primary Major Title"]||t[1]["Primary Major"])+"",D,I,r,i,c=t[1].Classification+"",u,h,w,B;function W(_,O){return _[1].githubUsername?tn:en}let X=W(t),L=X(t);function x(_,O){return _[1].slackUserId?sn:nn}let j=x(t),M=j(t);return{c(){e=v("div"),s=v("img"),p=H(),a=v("div"),m=v("div"),y=v("strong"),N=Y(d),G=H(),S=Y(q),F=H(),k=v("div"),g=Y(R),E=H(),T=v("div"),A=Y("Major: "),D=Y(C),I=H(),r=v("div"),i=Y("Class: "),u=Y(c),h=H(),L.c(),w=H(),M.c(),B=H(),ze(s.src,n=t[1].imageBlob||t[1].imageLink)||f(s,"src",n),f(s,"alt",l=t[1].First+" "+t[1].Last),f(s,"class","svelte-121v7tt"),f(a,"class","overlay svelte-121v7tt"),f(e,"class","card svelte-121v7tt")},m(_,O){ue(_,e,O),o(e,s),o(e,p),o(e,a),o(a,m),o(m,y),o(y,N),o(y,G),o(y,S),o(a,F),o(a,k),o(k,g),o(a,E),o(a,T),o(T,A),o(T,D),o(a,I),o(a,r),o(r,i),o(r,u),o(a,h),L.m(a,null),o(a,w),M.m(a,null),o(e,B)},p(_,O){O&1&&!ze(s.src,n=_[1].imageBlob||_[1].imageLink)&&f(s,"src",n),O&1&&l!==(l=_[1].First+" "+_[1].Last)&&f(s,"alt",l),O&1&&d!==(d=_[1].First+"")&&ce(N,d),O&1&&q!==(q=_[1].Last+"")&&ce(S,q),O&1&&R!==(R=_[1].EmailAddress+"")&&ce(g,R),O&1&&C!==(C=(_[1]["Primary Major Title"]||_[1]["Primary Major"])+"")&&ce(D,C),O&1&&c!==(c=_[1].Classification+"")&&ce(u,c),X===(X=W(_))&&L?L.p(_,O):(L.d(1),L=X(_),L&&(L.c(),L.m(a,w))),j===(j=x(_))&&M?M.p(_,O):(M.d(1),M=j(_),M&&(M.c(),M.m(a,null)))},d(_){_&&ae(e),L.d(),M.d()}}}function rn(t){let e,s=t[0],n=[];for(let l=0;l<s.length;l+=1)n[l]=bt(vt(t,s,l));return{c(){e=v("div");for(let l=0;l<n.length;l+=1)n[l].c();f(e,"class","grid svelte-121v7tt")},m(l,p){ue(l,e,p);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(l,[p]){if(p&1){s=l[0];let a;for(a=0;a<s.length;a+=1){const m=vt(l,s,a);n[a]?n[a].p(m,p):(n[a]=bt(m),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=s.length}},i:ie,o:ie,d(l){l&&ae(e),qe(n,l)}}}function ln(t,e,s){let{filteredRoster:n=[]}=e;return t.$$set=l=>{"filteredRoster"in l&&s(0,n=l.filteredRoster)},[n]}class an extends Ge{constructor(e){super(),He(this,e,ln,rn,Te,{filteredRoster:0})}}function yt(t,e,s){const n=t.slice();return n[1]=e[s],n}function on(t){let e;return{c(){e=v("div"),e.textContent="GitHub: N/A",f(e,"class","svelte-hgr9w8")},m(s,n){ue(s,e,n)},p:ie,d(s){s&&ae(e)}}}function cn(t){let e,s,n,l,p=t[1].githubUsername+"",a,m;return{c(){e=v("div"),s=Y("GitHub: "),n=v("a"),l=Y("@"),a=Y(p),f(n,"href",m="https://github.com/"+t[1].githubUsername),f(n,"target","_blank"),f(n,"rel","noopener"),f(n,"class","svelte-hgr9w8"),f(e,"class","svelte-hgr9w8")},m(y,d){ue(y,e,d),o(e,s),o(e,n),o(n,l),o(n,a)},p(y,d){d&1&&p!==(p=y[1].githubUsername+"")&&ce(a,p),d&1&&m!==(m="https://github.com/"+y[1].githubUsername)&&f(n,"href",m)},d(y){y&&ae(e)}}}function un(t){let e;return{c(){e=v("div"),e.textContent="Slack: N/A",f(e,"class","svelte-hgr9w8")},m(s,n){ue(s,e,n)},p:ie,d(s){s&&ae(e)}}}function fn(t){let e,s,n,l=(t[1].slackDisplayname||t[1].slackFullname||t[1].First)+"",p,a;return{c(){e=v("div"),s=Y("Slack: "),n=v("a"),p=Y(l),f(n,"href",a="https://penn-cis-3500.slack.com/team/"+t[1].slackUserId),f(n,"target","_blank"),f(n,"rel","noopener"),f(n,"class","svelte-hgr9w8"),f(e,"class","svelte-hgr9w8")},m(m,y){ue(m,e,y),o(e,s),o(e,n),o(n,p)},p(m,y){y&1&&l!==(l=(m[1].slackDisplayname||m[1].slackFullname||m[1].First)+"")&&ce(p,l),y&1&&a!==(a="https://penn-cis-3500.slack.com/team/"+m[1].slackUserId)&&f(n,"href",a)},d(m){m&&ae(e)}}}function kt(t){let e,s,n,l,p,a,m,y,d=t[1].First+"",N,G,q=t[1].Last+"",S,F,k,R=t[1].EmailAddress+"",g,E,T,A,C=(t[1]["Primary Major Title"]||t[1]["Primary Major"])+"",D,I,r,i,c=t[1].Classification+"",u,h,w,B;function W(_,O){return _[1].githubUsername?cn:on}let X=W(t),L=X(t);function x(_,O){return _[1].slackUserId?fn:un}let j=x(t),M=j(t);return{c(){e=v("div"),s=v("img"),p=H(),a=v("div"),m=v("div"),y=v("strong"),N=Y(d),G=H(),S=Y(q),F=H(),k=v("div"),g=Y(R),E=H(),T=v("div"),A=Y("Major: "),D=Y(C),I=H(),r=v("div"),i=Y("Class: "),u=Y(c),h=H(),L.c(),w=H(),M.c(),B=H(),ze(s.src,n=t[1].imageBlob||t[1].imageLink)||f(s,"src",n),f(s,"alt",l=t[1].First+" "+t[1].Last),f(s,"class","svelte-hgr9w8"),f(m,"class","svelte-hgr9w8"),f(k,"class","svelte-hgr9w8"),f(T,"class","svelte-hgr9w8"),f(r,"class","svelte-hgr9w8"),f(a,"class","student-details svelte-hgr9w8"),f(e,"class","student-row svelte-hgr9w8")},m(_,O){ue(_,e,O),o(e,s),o(e,p),o(e,a),o(a,m),o(m,y),o(y,N),o(y,G),o(y,S),o(a,F),o(a,k),o(k,g),o(a,E),o(a,T),o(T,A),o(T,D),o(a,I),o(a,r),o(r,i),o(r,u),o(a,h),L.m(a,null),o(a,w),M.m(a,null),o(e,B)},p(_,O){O&1&&!ze(s.src,n=_[1].imageBlob||_[1].imageLink)&&f(s,"src",n),O&1&&l!==(l=_[1].First+" "+_[1].Last)&&f(s,"alt",l),O&1&&d!==(d=_[1].First+"")&&ce(N,d),O&1&&q!==(q=_[1].Last+"")&&ce(S,q),O&1&&R!==(R=_[1].EmailAddress+"")&&ce(g,R),O&1&&C!==(C=(_[1]["Primary Major Title"]||_[1]["Primary Major"])+"")&&ce(D,C),O&1&&c!==(c=_[1].Classification+"")&&ce(u,c),X===(X=W(_))&&L?L.p(_,O):(L.d(1),L=X(_),L&&(L.c(),L.m(a,w))),j===(j=x(_))&&M?M.p(_,O):(M.d(1),M=j(_),M&&(M.c(),M.m(a,null)))},d(_){_&&ae(e),L.d(),M.d()}}}function dn(t){let e,s=t[0],n=[];for(let l=0;l<s.length;l+=1)n[l]=kt(yt(t,s,l));return{c(){e=v("div");for(let l=0;l<n.length;l+=1)n[l].c();f(e,"class","list svelte-hgr9w8")},m(l,p){ue(l,e,p);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(l,[p]){if(p&1){s=l[0];let a;for(a=0;a<s.length;a+=1){const m=yt(l,s,a);n[a]?n[a].p(m,p):(n[a]=kt(m),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=s.length}},i:ie,o:ie,d(l){l&&ae(e),qe(n,l)}}}function hn(t,e,s){let{filteredRoster:n=[]}=e;return t.$$set=l=>{"filteredRoster"in l&&s(0,n=l.filteredRoster)},[n]}class pn extends Ge{constructor(e){super(),He(this,e,hn,dn,Te,{filteredRoster:0})}}function gn(t){let e,s;return e=new pn({props:{filteredRoster:t[0]}}),{c(){Ve(e.$$.fragment)},m(n,l){Ne(e,n,l),s=!0},p(n,l){const p={};l&1&&(p.filteredRoster=n[0]),e.$set(p)},i(n){s||(Ee(e.$$.fragment,n),s=!0)},o(n){Ie(e.$$.fragment,n),s=!1},d(n){Pe(e,n)}}}function _n(t){let e,s;return e=new an({props:{filteredRoster:t[0]}}),{c(){Ve(e.$$.fragment)},m(n,l){Ne(e,n,l),s=!0},p(n,l){const p={};l&1&&(p.filteredRoster=n[0]),e.$set(p)},i(n){s||(Ee(e.$$.fragment,n),s=!0)},o(n){Ie(e.$$.fragment,n),s=!1},d(n){Pe(e,n)}}}function mn(t){let e;return{c(){e=v("p"),e.textContent="No students found. Upload data or adjust filters.",at(e,"text-align","center"),at(e,"color","#666")},m(s,n){ue(s,e,n)},p:ie,i:ie,o:ie,d(s){s&&ae(e)}}}function vn(t){let e,s,n,l=t[0].length+"",p,a,m=t[0].length===1?"":"s",y,d,N,G,q,S,F,k,R,g,E,T,A,C,D,I,r,i,c,u,h,w,B,W,X,L,x,j,M,_,O,U;c=new Yt({}),h=new Xt({});const Z=[mn,_n,gn],z=[];function te(P,b){return P[0].length===0?0:P[1]==="grid"?1:2}return j=te(t),M=z[j]=Z[j](t),{c(){e=v("div"),s=v("div"),n=v("div"),p=Y(l),a=Y(" record"),y=Y(m),d=Y(" displayed"),N=H(),G=v("div"),q=v("button"),q.textContent="Copy Emails",S=H(),F=v("div"),k=v("button"),k.textContent="Export Data",R=H(),g=v("div"),E=v("button"),E.textContent="JSON (All Data)",T=H(),A=v("button"),A.textContent="CSV (All Data)",C=H(),D=v("button"),D.textContent="Messages Only",I=H(),r=v("button"),r.textContent="Clear All Records",i=H(),Ve(c.$$.fragment),u=H(),Ve(h.$$.fragment),w=H(),B=v("div"),W=v("button"),W.textContent="Grid View",X=H(),L=v("button"),L.textContent="List View",x=H(),M.c(),f(q,"class","svelte-bje4cp"),f(k,"class","export-btn svelte-bje4cp"),f(E,"class","svelte-bje4cp"),f(A,"class","svelte-bje4cp"),f(D,"class","svelte-bje4cp"),f(g,"class","export-content svelte-bje4cp"),f(F,"class","export-dropdown svelte-bje4cp"),f(r,"class","svelte-bje4cp"),f(s,"class","top-bar svelte-bje4cp"),f(W,"class","svelte-bje4cp"),_e(W,"active",t[1]==="grid"),f(L,"class","svelte-bje4cp"),_e(L,"active",t[1]==="list"),f(B,"class","view-switcher svelte-bje4cp")},m(P,b){ue(P,e,b),o(e,s),o(s,n),o(n,p),o(n,a),o(n,y),o(n,d),o(s,N),o(s,G),o(G,q),o(G,S),o(G,F),o(F,k),o(F,R),o(F,g),o(g,E),o(g,T),o(g,A),o(g,C),o(g,D),o(G,I),o(G,r),o(e,i),Ne(c,e,null),o(e,u),Ne(h,e,null),o(e,w),o(e,B),o(B,W),o(B,X),o(B,L),o(e,x),z[j].m(e,null),_=!0,O||(U=[oe(q,"click",t[4]),oe(E,"click",t[8]),oe(A,"click",t[9]),oe(D,"click",t[10]),oe(r,"click",t[3]),oe(W,"click",t[11]),oe(L,"click",t[12])],O=!0)},p(P,[b]){(!_||b&1)&&l!==(l=P[0].length+"")&&ce(p,l),(!_||b&1)&&m!==(m=P[0].length===1?"":"s")&&ce(y,m),(!_||b&2)&&_e(W,"active",P[1]==="grid"),(!_||b&2)&&_e(L,"active",P[1]==="list");let J=j;j=te(P),j===J?z[j].p(P,b):(Dt(),Ie(z[J],1,1,()=>{z[J]=null}),Nt(),M=z[j],M?M.p(P,b):(M=z[j]=Z[j](P),M.c()),Ee(M,1),M.m(e,null))},i(P){_||(Ee(c.$$.fragment,P),Ee(h.$$.fragment,P),Ee(M),_=!0)},o(P){Ie(c.$$.fragment,P),Ie(h.$$.fragment,P),Ie(M),_=!1},d(P){P&&ae(e),Pe(c),Pe(h),z[j].d(),O=!1,Ce(U)}}}function bn(t,e,s){let n,l,p;$e(t,Ze,R=>s(6,l=R)),$e(t,ve,R=>s(7,p=R)),le.setLevel("debug");let a="grid";function m(R){s(1,a=R)}function y(){confirm("Are you sure you want to clear all records?")&&ve.set([])}async function d(){const R=n.map(g=>g.EmailAddress).filter(g=>g&&g.trim()!=="");try{await navigator.clipboard.writeText(R.join(", ")),alert(`Copied ${R.length} emails to clipboard.`)}catch(g){alert("Failed to copy emails: "+g)}}function N(R){if(n.length===0){alert("No data to export.");return}let g,E,T;if(R==="json"){const I=JSON.parse(JSON.stringify(n));I.forEach(r=>{r.messages||(r.messages=[])}),g=JSON.stringify(I,null,2),E="student-data.json",T="application/json"}else if(R==="csv"){const I=new Set;n.forEach(c=>{Object.keys(c).forEach(u=>{u!=="messages"&&I.add(u)})}),I.add("hasMessages");const r=Array.from(I),i=[r.join(",")];n.forEach(c=>{const u=r.map(h=>{if(h==="hasMessages")return c.messages&&c.messages.length>0?"true":"false";const w=c[h]||"";return typeof w=="object"&&w!==null&&!Array.isArray(w)?`"${JSON.stringify(w).replace(/"/g,'""')}"`:Array.isArray(w)?w.length:typeof w=="string"?`"${w.replace(/"/g,'""')}"`:w});i.push(u.join(","))}),g=i.join(`
`),E="student-data.csv",T="text/csv"}else if(R==="messages-only"){const I={};n.forEach(r=>{if(r.messages&&r.messages.length>0){const i=`${r.First||""} ${r.Last||""} (${r.studentId})`;I[i]=r.messages}}),g=JSON.stringify(I,null,2),E="student-messages.json",T="application/json"}else{alert("Unsupported export format");return}const A=new Blob([g],{type:T}),C=URL.createObjectURL(A),D=document.createElement("a");D.href=C,D.download=E,document.body.appendChild(D),D.click(),setTimeout(()=>{document.body.removeChild(D),URL.revokeObjectURL(C)},100)}const G=()=>N("json"),q=()=>N("csv"),S=()=>N("messages-only"),F=()=>m("grid"),k=()=>m("list");return t.$$.update=()=>{t.$$.dirty&192&&s(0,n=p.filter(R=>{let g=!0;if(l.search&&l.search.trim()!==""){const E=l.search.toLowerCase(),T=((R.First||"")+" "+(R.Last||"")).toLowerCase(),A=(R.EmailAddress||"").toLowerCase();!T.includes(E)&&!A.includes(E)&&(g=!1)}if(l.hasGitHub==="yes"&&!R.githubUsername&&(g=!1),l.hasGitHub==="no"&&R.githubUsername&&(g=!1),l.hasSlack==="yes"&&!R.slackUserId&&(g=!1),l.hasSlack==="no"&&R.slackUserId&&(g=!1),l.major&&l.major!=="all"){const E=l.major.toLowerCase();(R["Primary Major Title"]||R["Primary Major"]||"").toLowerCase().includes(E)||(g=!1)}return l.classification&&l.classification!=="all"&&(R.Classification||"").toLowerCase()!==l.classification.toLowerCase()&&(g=!1),g})),t.$$.dirty&1&&le.debug("Filtered roster count:",n.length)},[n,a,m,y,d,N,l,p,G,q,S,F,k]}class yn extends Ge{constructor(e){super(),He(this,e,bn,vn,Te,{})}}async function kn(){await Vt(),new yn({target:document.getElementById("app")})}kn();app;
